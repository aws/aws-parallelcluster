Image:
  Os: centos8
  CustomAmi: ami-12345678
HeadNode:
  InstanceType: t2.micro  # t2.micro
  Networking:
    SubnetId: subnet-12345678  # subnet-xxx
    ElasticIp: String  # true|false|EIP-id
    AssignPublicIp: True  # true|false
    SecurityGroups:
      - sg-12345678
      - sg-23456789
    AdditionalSecurityGroups:
      - sg-34567890
      - sg-45678901
    Proxy:
      HttpProxyAddress: String  # https://proxy-address:port
  SimultaneousMultithreading: true
  Image:
    Os: centos8
    CustomAmi: ami-23456789
  Ssh:
    KeyName: ec2-key-name
    AllowedIps: 1.2.3.4/32
  Storage:
    RootVolume:
      Size: 40
      Encrypted: true
      KmsKeyId: String
      VolumeType: gp2
      Iops: 100
      Throughput: 150
    EphemeralVolume:
      Encrypted: true
      MountDir: /test
  Dcv:
    Enabled: true
    Port: 8443
    AllowedIps: 0.0.0.0/0
  CustomActions:
    - Script: s3://test/template.tgz  # s3:// | https:// | file://*
      Args:
        - String  # arg1
        - stirng2
      Event: NODE_START
      RunAs: String
  Efa:
    Enabled: false
    GdrSupport: false
  Iam:
    Roles:
      InstanceRole: String  # arn:aws:iam::aws:role/CustomHeadNodeRole
      CustomLambdaResources: String  # arn:aws:iam::aws:role/CustomResourcesLambdaRole
    S3Access:
      - BucketName: String
        Type: READ_ONLY
    AdditionalIamPolicies:
      - Policy: String  # arn:aws:iam::aws:policy/AdministratorAccess
Scheduling:
  Slurm:
    Settings:
      ScaledownIdletime: 10
      Dns:
        DisableManagedDns: true
        Domain: String
        HostedZoneId: String
    Queues:
      - Name: queue1
        ComputeType: ONDEMAND
        Networking:
          SubnetIds:
            - subnet-12345678
        ComputeResources:
          - Name: compute_resource1
            InstanceType: c5.xlarge
          - Name: compute_resource2
            InstanceType: c4.xlarge
        Image:
          Os: centos8
          CustomAmi: ami-23456789
        CustomActions:
          - Script: s3://test/template.tgz  # s3:// | https:// | file://*
            Args:
              - String  # arg1
              - stirng2
            Event: NODE_START
            RunAs: String
        Iam:
          Roles:
            InstanceRole: String  # arn:aws:iam::aws:role/CustomHeadNodeRole
            CustomLambdaResources: String  # arn:aws:iam::aws:role/CustomResourcesLambdaRole
          S3Access:
            - BucketName: String
              Type: READ_ONLY
          AdditionalIamPolicies:
            - Policy: String  # arn:aws:iam::aws:policy/AdministratorAccess
      - Name: queue2
        Storage:
          RootVolume:
            Size:  25
            Encrypted:  true
            KmsKeyId: String
            VolumeType: gp2
            Iops: 100
            Throughput: 100
          EphemeralVolume:
            Encrypted: true
            MountDir: /scratch
        Networking:
          SubnetIds:
            - subnet-12345678
            - subnet-23456789
          AssignPublicIp: true
          SecurityGroups:
            - sg-12345678
          AdditionalSecurityGroups:
            - sg-23456789
          PlacementGroup:
            Enabled: true
            Id: String
          Proxy:
            HttpProxyAddress: String  # https://proxy-address:port
        ComputeResources:
          - Name: compute_resource_1
            InstanceType: c4.2xlarge
          - Name: compute_resource_2
            InstanceType: c5.2xlarge
            MinCount: 1
            MaxCount: 15
            SpotPrice: 1.1
            SimultaneousMultithreading: false
            Efa:
              Enabled: true
              GdrSupport: false
            AllocationStrategy: String
SharedStorage:
  - MountDir: /my/mount/point1
    Ebs:
      VolumeType: gp2  # gp2 | gp3 | io1 | io2 | sc1 | st1 | standard
      Iops: 100
      Size: 150
      Encrypted: True
      KmsKeyId: String
      SnapshotId: snap-12345678
      VolumeId: vol-12345678
  - MountDir: /my/mount/point2
    Efs:
      ThroughputMode: provisioned  # bursting | provisioned
      ProvisionedThroughput: 1024
  - MountDir: /my/mount/point3
    FsxLustre:
      StorageCapacity: 3600
      DeploymentType: PERSISTENT_1  # PERSISTENT_1 | SCRATCH_1 | SCRATCH_2
      ImportedFileChunkSize: 1024
      ExportPath: String  # s3://bucket/folder
      ImportPath: String  # s3://bucket
      # WeeklyMaintenanceStartTime: 1:00:00
      AutomaticBackupRetentionDays: 0
      CopyTagsToBackups: true
      DailyAutomaticBackupStartTime: 01:03
      PerUnitStorageThroughput: 200
      # BackupId: backup-fedcba98 # BackupId cannot coexist with some of the fields
      KmsKeyId: String  # xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
      # FileSystemId: fs-12345678123456789 # FileSystemId cannot coexist with some of the fields
      AutoImportPolicy: NEW  # NEW | NEW_CHANGED
      DriveCacheType: READ  # READ
      StorageType: HDD  # HDD | SSD
Iam:
  Roles:
    InstanceRole: String  # arn:aws:iam::aws:role/CustomHeadNodeRole
    CustomLambdaResources: String  # arn:aws:iam::aws:role/CustomResourcesLambdaRole
  S3Access:
    - BucketName: String
      Type: READ_ONLY
  AdditionalIamPolicies:
    - Policy: String  # arn:aws:iam::aws:policy/AdministratorAccess
    - Policy: policy2
Monitoring:
  DetailedMonitoring: true  # false
  Logs:
    CloudWatch:
      Enabled: true  # true
      RetentionInDays: 30  # 14
      LogGroupId: String
      KmsKeyId: String
  Dashboards:
    CloudWatch:
      Enabled: true  # true
AdditionalPackages:
  IntelSelectSolutions:
    InstallIntelSoftware: false
Tags:
  - Key: String
    Value: String
  - Key: two
    Value: two22
ClusterS3Bucket: String
AdditionalResources: String  # https://template.url
DevSettings:
  ClusterTemplate: file:///tests/aws-parallelcluster-template-3.0.tgz
  Cookbook:
    ChefCookbook: file:///tests/aws-parallelcluster-cookbook-3.0.tgz
    ExtraChefAttributes: |
      {"cluster": {"cfn_scheduler_slots": "cores"}}
  AwsBatchCliPackage: s3://test/aws-parallelcluster-batch-3.0.tgz
  NodePackage: s3://test/aws-parallelcluster-node-3.0.tgz