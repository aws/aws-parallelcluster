{%- import 'common.jinja2' as common with context -%}
---
test-suites:
{{- common.OSS_COMMERCIAL_ARM.append("centos7") or "" -}}
{% filter indent(2) %}
{% include 'common/common.yaml' %}
{% endfilter %}
  scaling:
    # FixMe: MPI tests configs are duplications of the test in common.yaml.
    # The duplications are necessary because the scaling section here overwrites the scaling section in common.yaml.
    test_mpi.py::test_mpi:
      dimensions:
        - regions: ["ap-east-1"]
          instances: {{ common.INSTANCES_DEFAULT_X86 }}
          oss: {{ common.OSS_COMMERCIAL_X86 }}
          schedulers: ["slurm"]
        - regions: ["eu-west-2"]
          instances: {{ common.INSTANCES_DEFAULT_ARM }}
          oss: {{ common.OSS_COMMERCIAL_ARM }}
          schedulers: ["slurm"]
    test_mpi.py::test_mpi_ssh:
      dimensions:
        - regions: ["eu-north-1"]
          instances: {{ common.INSTANCES_DEFAULT_X86 }}
          oss: {{ common.OSS_COMMERCIAL_X86 }}
          schedulers: ["slurm"]
    test_scaling.py::test_multiple_jobs_submission:
      dimensions:
        - regions: {{ common.REGIONS_COMMERCIAL }}
          instances: {{ common.INSTANCES_DEFAULT_X86 }}
          oss: {{ common.OSS_COMMERCIAL_X86 }}
          schedulers: ["slurm"]
        - regions: {{ common.REGIONS_CHINA }}
          instances: {{ common.INSTANCES_DEFAULT_X86 }}
          oss: {{ common.OSS_CHINA_X86 }}
          schedulers: ["slurm"]
        - regions: {{ common.REGIONS_GOVCLOUD }}
          instances: {{ common.INSTANCES_DEFAULT_X86 }}
          oss: {{ common.OSS_GOVCLOUD_X86 }}
          schedulers: ["slurm"]
        - regions: ["us-west-2"]
          instances: {{ common.INSTANCES_DEFAULT_ARM }}
          oss: {{ common.OSS_COMMERCIAL_ARM }}
          schedulers: {{ common.SCHEDULERS_TRAD }}
        - regions: ["cn-north-1"]
          instances: {{ common.INSTANCES_DEFAULT_ARM }}
          oss: {{ common.OSS_CHINA_ARM }}
          schedulers: ["slurm"]
        - regions: ["us-gov-east-1"]
          instances: {{ common.INSTANCES_DEFAULT_ARM }}
          oss: {{ common.OSS_GOVCLOUD_ARM }}
          schedulers: ["slurm"]
