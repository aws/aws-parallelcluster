Image:
  Os: {{ os }}
  CustomAmi: {{ global_custom_ami }}
CustomS3Bucket: {{ resource_bucket }}
HeadNode:
  InstanceType: {{ instance }}
  LocalStorage:
    RootVolume:
      Size: {{ root_volume_size }}
      Encrypted: {{ encrypted }}
      VolumeType: {{ volume_type }}
  Networking:
    SubnetId: {{ public_subnet_id }}
  Ssh:
    KeyName: {{ key_name }}
  CustomActions:
    OnNodeStart:
      Script: s3://{{ bucket }}/scripts/preinstall.sh
      Args:
        - ABC
    OnNodeConfigured:
      Script: s3://{{ bucket }}/scripts/postinstall.sh
      Args:
        - DEF
  Iam:
    S3Access:
      - BucketName: {{ resource_bucket }}
        EnableWriteAccess: true
  Image:
    CustomAmi: {{ headnode_custom_ami }}
Scheduling:
  Scheduler: slurm
  SlurmQueues:
    - Name: queue1
      ComputeResources:
        - Name: queue1-i1
          InstanceType: c5.xlarge
          MinCount: 1
          MaxCount: 2
        - Name: queue1-i2
          InstanceType: t2.micro
          MinCount: 1
          MaxCount: 2
      Networking:
        SubnetIds:
          - {{ private_subnet_id }}