[global]
cluster_template = default

[aws]
aws_region_name = {{ region }}

[cluster default]
base_os = {{ os }}
key_name = {{ key_name }}
vpc_settings = parallelcluster-vpc
scheduler = slurm
master_instance_type = {{ instance }}
queue_settings = broken, half-broken, normal
s3_read_resource = arn:aws:s3:::{{ bucket }}/scripts/*
# pre-install script to make c5.large instance type instance has bootstrap error
pre_install = s3://{{ bucket }}/scripts/preinstall.sh

[queue broken]
compute_resource_settings = broken-static

[queue half-broken]
compute_resource_settings = broken-dynamic,working-static

[queue normal]
compute_resource_settings = normal

[compute_resource broken-static] # instance type has bootstrap failure
instance_type = c5.large
min_count = 2
max_count = 250

[compute_resource working-static] # instance type work as expected
instance_type = c5.xlarge
min_count = 1
max_count = 250

[compute_resource broken-dynamic] # instance type has bootstrap failure
instance_type = c5.large
max_count = 250

[compute_resource normal] # instance type work as expected
instance_type = c5.xlarge
min_count = 1
max_count = 250

[vpc parallelcluster-vpc]
vpc_id = {{ vpc_id }}
master_subnet_id = {{ public_subnet_id }}
compute_subnet_id = {{ private_subnet_id }}
use_public_ips = false
